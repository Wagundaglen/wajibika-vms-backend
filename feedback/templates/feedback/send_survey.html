{% extends "base.html" %}
{% block content %}
<h2>Send Survey</h2>

<form method="POST">
    {% csrf_token %}

    <div class="mb-3">
        <label for="{{ form.survey.id_for_label }}" class="form-label">Select Survey:</label>
        {{ form.survey }}
    </div>

    <div class="mb-3">
        <label class="form-label">Send To:</label><br>
        {{ form.send_to }}  <!-- Use the Django form field instead of hardcoding -->
    </div>

    <div class="mb-3" id="volunteers_div" style="display: none;">
        <label for="{{ form.volunteers.id_for_label }}" class="form-label">Select Volunteers:</label>
        {{ form.volunteers }}
        <small class="form-text text-muted">
            Hold Ctrl (Windows) or Command (Mac) to select multiple volunteers.
        </small>
    </div>

    <button type="submit" class="btn btn-primary">Send Survey</button>
</form>

<script>
    const sendToRadios = document.querySelectorAll('input[name="send_to"]');
    const volunteersDiv = document.getElementById('volunteers_div');

    function toggleVolunteers() {
        const selected = document.querySelector('input[name="send_to"]:checked').value;
        volunteersDiv.style.display = (selected === 'specific') ? 'block' : 'none';
    }

    sendToRadios.forEach(radio => {
        radio.addEventListener('change', toggleVolunteers);
    });

    // Initialize on page load
    toggleVolunteers();
</script>
{% endblock %}
